Below are **clean, exam-style, step-by-step solutions** for every Storage & LVM task.
This is exactly how you should perform these operations during the RHCSA exam â€” fast, precise, and verifiable.

---

# ðŸ”µ **1. Create a new physical volume (PV)**

Assume disk: **/dev/sdb**

### **Steps**

```bash
sudo pvcreate /dev/sdb
```

### **Verify**

```bash
sudo pvs
sudo pvdisplay /dev/sdb
```

---

# ðŸ”µ **2. Create a volume group (VG) from two disks**

Assume disks: **/dev/sdb** and **/dev/sdc**
VG name: **vgdata**

### **Steps**

```bash
sudo pvcreate /dev/sdc
sudo vgcreate vgdata /dev/sdb /dev/sdc
```

### **Verify**

```bash
sudo vgs
sudo vgdisplay vgdata
```

---

# ðŸ”µ **3. Create a logical volume (LV) and format it as XFS**

LV name: **lvfiles**
Size: **5G**

### **Steps**

1. Create LV:

```bash
sudo lvcreate -L 5G -n lvfiles vgdata
```

2. Format as XFS:

```bash
sudo mkfs.xfs /dev/vgdata/lvfiles
```

### **Verify**

```bash
sudo lvs
sudo blkid /dev/vgdata/lvfiles
```

---

# ðŸ”µ **4. Mount the filesystem persistently using `/etc/fstab`**

### Directory: **/mnt/files**

### **Steps**

1. Create mountpoint:

```bash
sudo mkdir -p /mnt/files
```

2. Get UUID:

```bash
sudo blkid /dev/vgdata/lvfiles
```

Example output:

```
UUID="abcd-1234-xyz"
```

3. Edit `/etc/fstab`:

```bash
sudo nano /etc/fstab
```

Add line:

```
UUID=abcd-1234-xyz   /mnt/files   xfs   defaults   0 0
```

4. Mount all:

```bash
sudo mount -a
```

### **Verify**

```bash
df -h | grep files
```

---

# ðŸ”µ **5. Extend a logical volume AND the filesystem**

Assume you want to **add 2G** to the existing LV.

### **XFS filesystem (RHCSA uses this most often)**

XFS **cannot** be reduced, but can be extended online.

### **Steps**

1. Extend LV:

```bash
sudo lvextend -L +2G /dev/vgdata/lvfiles
```

2. Grow filesystem:

```bash
sudo xfs_growfs /mnt/files
```

*(xfs_growfs requires the filesystem to be mounted)*

### **Verify**

```bash
df -h /mnt/files
sudo lvs vgdata
```

---

# ðŸ”µ **6. Reduce an LVM volume safely (ext4 only!)**

XFS cannot shrink â€” this is why Red Hat tests this on **ext4**.

Assume LV: `/dev/vgdata/lvext`
Target size: **3G**
Mountpoint: `/mnt/extdata`

---

### **Steps (safe method)**

1. Unmount filesystem:

```bash
sudo umount /mnt/extdata
```

2. Run filesystem check:

```bash
sudo e2fsck -f /dev/vgdata/lvext
```

3. Shrink filesystem to slightly **less** than target:

```bash
sudo resize2fs /dev/vgdata/lvext 3G
```

4. Reduce the LV:

```bash
sudo lvreduce -L 3G /dev/vgdata/lvext
```

5. Grow filesystem to use full LV (harmless final sync):

```bash
sudo resize2fs /dev/vgdata/lvext
```

6. Mount again:

```bash
sudo mount /mnt/extdata
```

### **Verify**

```bash
df -h /mnt/extdata
sudo lvs
```

---

# ðŸ”µ **7. Create and activate a swap partition or swap file**

RHCSA tests both; you must know both.

---

## **Option A â€” Swap Partition**

Assume partition: **/dev/sdd1**

### **Steps**

1. Format as swap:

```bash
sudo mkswap /dev/sdd1
```

2. Enable:

```bash
sudo swapon /dev/sdd1
```

3. Make persistent in `/etc/fstab`:

```
/dev/sdd1   swap   swap   defaults   0 0
```

### **Verify**

```bash
sudo swapon --show
```

---

## **Option B â€” Swap File (Very Common in Exams)**

Create a 1G swap file at `/swapfile`.

### **Steps**

1. Create file:

```bash
sudo dd if=/dev/zero of=/swapfile bs=1M count=1024
```

2. Secure permissions:

```bash
sudo chmod 600 /swapfile
```

3. Make swap:

```bash
sudo mkswap /swapfile
```

4. Enable:

```bash
sudo swapon /swapfile
```

5. Add to `/etc/fstab`:

```
/swapfile   swap   swap   defaults   0 0
```

### **Verify**

```bash
sudo swapon --show
```

---

Great â€” here is a **full, realistic, RHCSA-style Storage & LVM challenge**, exactly the type of multi-part scenario Red Hat uses to test your speed, precision, and problem-solving under pressure.

This combines **every storage operation** you must know: PV, VG, LV, XFS, ext4 shrinking, mounting, fstab, swap, and troubleshooting.

Iâ€™ll provide:

1. **Full exam-style scenario (task sheet)**
2. **Step-by-step solution**
3. **Verification checklist** (what graders check)

---

# ðŸ”¥ **RHCSA Storage & LVM Full Exam Scenario**

You are given a RHEL system with three unused disks:

* **/dev/sdb**
* **/dev/sdc**
* **/dev/sdd**

Complete the following tasks.

---

# **ðŸ”· 1) Create a new LVM storage environment**

1. Create **physical volumes** on `/dev/sdb` and `/dev/sdc`.
2. Create a volume group named **vgdata** using both PVs.
3. Create a **6GB logical volume** named `lvxfs` inside `vgdata`.
4. Format the LV using **XFS**.
5. Mount it permanently at **/mnt/xfsdata**.

---

# **ðŸ”· 2) Extend the XFS filesystem**

Increase the size of the logical volume `lvxfs` by **+4GB**, then grow the filesystem accordingly.

---

# **ðŸ”· 3) Create and shrink an ext4 LVM filesystem**

1. Create a **4GB LV** named `lvext` inside `vgdata`.
2. Format it as **ext4**.
3. Mount the LV at `/mnt/extdata`.
4. Shrink the filesystem and LV safely to **2GB**.
   *(This must be done with zero data-loss and proper steps.)*

---

# **ðŸ”· 4) Create swap storage**

You must configure **2GB of swap**, using one of the following:

* either `/dev/sdd1` as a swap partition
* or `/swapfile` using a file

Make the swap **persistent**, and active immediately.

---

# **ðŸ”· 5) Troubleshoot and fix fstab**

The system administrator reports that after reboot, the system fails to mount `/mnt/xfsdata` due to a bad `/etc/fstab` entry.

Diagnose and fix the issue so the system boots normally.

---

# ----------------------------------------------------

# ðŸ§  **Step-by-Step Solution**

---

# ðŸ”µ **1) Create PVs, VG, LV, format, and mount XFS**

### Create PVs

```bash
sudo pvcreate /dev/sdb /dev/sdc
```

### Create VG

```bash
sudo vgcreate vgdata /dev/sdb /dev/sdc
```

### Create 6 GB LV

```bash
sudo lvcreate -L 6G -n lvxfs vgdata
```

### Format as XFS

```bash
sudo mkfs.xfs /dev/vgdata/lvxfs
```

### Create mountpoint

```bash
sudo mkdir -p /mnt/xfsdata
```

### Get UUID

```bash
sudo blkid /dev/vgdata/lvxfs
```

### Add to /etc/fstab

```
UUID=<UUID-HERE>   /mnt/xfsdata   xfs   defaults   0 0
```

### Mount

```bash
sudo mount -a
```

---

# ðŸ”µ **2) Extend LV and grow XFS**

### Extend LV by 4GB

```bash
sudo lvextend -L +4G /dev/vgdata/lvxfs
```

### Grow XFS online

```bash
sudo xfs_growfs /mnt/xfsdata
```

---

# ðŸ”µ **3) Create & shrink ext4 LV**

### Create LV (4GB)

```bash
sudo lvcreate -L 4G -n lvext vgdata
```

### Format as ext4

```bash
sudo mkfs.ext4 /dev/vgdata/lvext
```

### Mount directory

```bash
sudo mkdir -p /mnt/extdata
sudo mount /dev/vgdata/lvext /mnt/extdata
```

### Unmount before resizing

```bash
sudo umount /mnt/extdata
```

### Force filesystem check

```bash
sudo e2fsck -f /dev/vgdata/lvext
```

### Shrink filesystem to 2GB

```bash
sudo resize2fs /dev/vgdata/lvext 2G
```

### Shrink LV to 2GB

```bash
sudo lvreduce -L 2G /dev/vgdata/lvext
```

### Final sync resize

```bash
sudo resize2fs /dev/vgdata/lvext
```

### Mount again

```bash
sudo mount /dev/vgdata/lvext /mnt/extdata
```

---

# ðŸ”µ **4) Create 2GB swap**

## Option A â€” Swap partition (if /dev/sdd1 exists)

```bash
sudo mkswap /dev/sdd1
sudo swapon /dev/sdd1
```

Add to `/etc/fstab`:

```
/dev/sdd1   swap   swap   defaults   0 0
```

## Option B â€” Swap file (safer)

```bash
sudo dd if=/dev/zero of=/swapfile bs=1M count=2048
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

Add to `/etc/fstab`:

```
/swapfile   swap   swap   defaults   0 0
```

---

# ðŸ”µ **5) Fix fstab boot issue**

### Test fstab without reboot:

```bash
sudo mount -a
```

If errors appear, correct them in `/etc/fstab`:

Common mistakes:

* wrong UUID
* missing filesystem type
* extra spaces
* wrong device name

After fixing:

```bash
sudo mount -a
```

Once clean:

```bash
sudo reboot
```

System should boot normally.

---

# ----------------------------------------------------

# ðŸŸ¢ **Verification Checklist (Exam-Ready)**

You should verify each part like this:

---

### **Check PVs**

```bash
pvs
```

### **Check VG**

```bash
vgs
```

### **Check LVs**

```bash
lvs
```

### **Check XFS mount**

```bash
df -h | grep xfsdata
```

### **Check ext4 mount**

```bash
df -h | grep extdata
```

### **Check swap**

```bash
swapon --show
```

### **Check fstab correctness**

```bash
mount -a
```

---
